<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <title>南通科技局</title>
    <link rel="stylesheet" href="../../lib/layui/css/layui.css" />
    <style>
        .layui-inline {
            margin-bottom: 10px;
        }

        .layui-form-label {
            width: 150px
        }
    </style>

</head>

<body>
    <div class="layui-tab-brief" style="margin-top: 10px">
        <form class="layui-form" id="demofrom">


            <div class="layui-inline">
                <label class="layui-form-label">编号
                    <span style="color:red;">*</span>
                </label>
                <div class="layui-input-inline">
                    <input type="text" name="number" lay-verify="required|isExistNumber" autocomplete="off" class="layui-input" placeholder="请输入昵称"
                    />
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">图片</label>
                <div class="layui-input-inline">
                    <img class="layui-upload-img" id="demo1" name="file">
                    <input type="button" class="layui-btn" value="上传图片" id="upload" />
                    <input type="hidden" name="flag" class="layui-input" />

                </div>
            </div>

            <div class="layui-inline">
                <label class="layui-form-label">企业类型名称（资质）
                    <span style="color:red;">*</span>
                </label>
                <div class="layui-input-inline">
                    <input type="text" name="typeName" lay-verify="required" autocomplete="off" class="layui-input" placeholder="请输入企业类型名称（资质）">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">有效年限
                    <span style="color:red;">*</span>
                </label>
                <div class="layui-input-inline">
                    <input type="text" name="year" class="layui-input" autocomplete="off" placeholder="请输入有效年限" />
                </div>
            </div>



            <div class="layui-form-item">
                <div class="layui-input-block" style="text-align:center;margin:0 auto;">
                    <button class="layui-btn" lay-submit="" lay-filter="submit">立即提交</button>
                    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                </div>
            </div>

        </form>

    </div>
    <script type="text/javascript" src="../../js/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="../../lib/layui/layui.js"></script>
    <script type="text/javascript" src="../../js/jquery.form.js"></script>
    <script type="text/javascript" src="../../js/main.js"></script>
    <script type="text/javascript">
        layui.use(['form', 'upload'], function () {
            var form = layui.form;
            var upload = layui.upload;
            var layer=layui.layer;
            upload.render({
                elem: '#upload',
                url: baseUrl + 'file/upload?token='+localStorage.getItem('token')+'&savepath=/company/icon',
                before: function (obj) {
                    //预读本地文件示例，不支持ie8
                    obj.preview(function (index, file, result) {
                        $('#demo1').attr('src', result); //图片链接（base64）
                    });
                },
                done:function(res){
                    console.log(res);

                },
                error:function(res){
                    console.log(res)
                    // layer.msg("上传失败")
                }

            })
            form.verify({
                isExistNumber: function (value) {
                    var msg;
                    $.ajax({
                        url: baseUrl + '/companytype/isExistNumber',
                        type: 'post',
                        dataType: 'json',
                        timeout: 10000,
                        async: false,
                        data: {
                            token: localStorage.getItem('token'),
                            number: value
                        },
                        success: function (response) {
                            if (response.status != 1) {
                                console.log(response.msg);
                                msg = response.msg;

                            }
                        }

                    });
                    return msg;

                }

            });

        });
    </script>
</body>

</html>