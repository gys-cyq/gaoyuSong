<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <title>崇川科技局项目管理系统</title>
    <link rel="stylesheet" href="../../static/css/font.css"  />
    <link rel="stylesheet" href="../../lib/layui/css/layui.css" />
    <link rel="stylesheet" href="../../css/style.css"  />
    <script type="text/javascript" src="../../js/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="../../lib/layui/layui.js"></script>
    <script type="text/javascript" src="../../js/main.js"></script>
    <style>
        .layui-table-cell{
            height:auto;
            white-space: normal;
            word-wrap: break-word;
            word-break: break-all
        }
    </style>
</head>
<body>
<div class="layui-tab-brief">
    <!--<div style="margin:10px;">
        <div>
            <button class="layui-btn layui-btn-small" onclick="openChangeLayer()" id="addbutton">添加</button>
        </div>
    </div>-->
    <!--<fieldset class="layui-elem-field">-->
        <div class="layui-field-box">
            <table class="style-table" id="expertList" lay-filter="expertList">
            </table>
        </div>
    <!--</fieldset>-->
</div>
<script type="text/html" id="toolbarDemo">
  <div class="layui-btn-container">
    <button class="layui-btn layui-btn-sm" lay-event="isAll">变更</button>
  </div>
</script>
<script type="text/html" id="expertAction">
    <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="edit" style="background-color:#2fa4e7;color:#fff;">变更</a>
</script>
<script type="text/javascript">
    var schoolMajor;
    var areaFind;
    token = localStorage.getItem("token");
    var form;
    layui.use(['table','layer','jquery','upload'],function(){
        var layer = layui.layer,
            table = layui.table,
            $ = layui.jquery,
            upload = layui.upload;
        form = layui.form;
        findschoolMajor();

        table.render({
            elem: '#expertList',
            url:baseUrl+'/expert/findExpertByPage',
            where:{token:token},
            toolbar: '#toolbarDemo',
            parseData: function(res){
                return {
                    "code" : 0,
                    "msg" : res.msg,
                    "count" : res.data.total,
                    "data" : res.data.list,
                }
            },
            page: true, //开启分页
            id:'expertId',
            cols: [[ //表头
            	{type:'checkbox'},
                {field: 'headImg', templet: function (data) {
//                    if (data.headImg != "") {
//                        var image = baseUrl + '/file/getImg?path=' + data.headImg;
//                        var html='';
//                        if(data.headImg==null){
//                            html = '<div>' + '<img src="../../img/touxiang.jpg" class="layui-upload-img" style="width:70px;">' + '</img>' + '</div>';
//                        }else{
//                            html = '<div>' + '<img src="' + image + '" class="layui-upload-img" style="width:70px;">' + '</img>' + '</div>';
//                        }
//                        return html;
//                    } else {
//                        return ''
//                    }
                    var image = baseUrl + '/file/getImg?path=' + data.headImg;
                    var unimage = baseUrl+'/images/touxiang.jpg';
                    var html='';
                    if (data.headImg != ""&&data.headImg!=null) {
                        html = '<div>' + '<img src="' + image + '" class="layui-upload-img" style="width:70px;">' + '</img>' + '</div>';
                        return html;
                    } else {
                        html = '<div>' + '<img src="'+unimage+'" class="layui-upload-img" style="width:70px;">' + '</img>' + '</div>';
                        return html;
                    }

                }, title: '头像'},
                {field: 'name', title: '专家姓名'},
                {field: 'sex', title: '性别',templet:function(d){
                    if(d.sex=='M'){
                        return '男';
                    }else if(d.sex=='F'){
                        return '女';
                    }else{
                        return '男';
                    }
                }},
                {field: 'area',templet:function(d){
                    if(d.area==1){
                        return '市内';
                    }else if(d.area==2){
                        return '市外';
                    }else{
                        return '';
                    }
                }, title: '所在地区'},
                {field: 'workMajorName', title: '从事专业名'},
                {field:'',title:'操作',templet:'#expertAction'},
            ]],
            done: function (res,cuur,count) {
                layer.closeAll('loading');
            }
        });

//      window.openChangeLayer = function(){
//        layer.open({
//            title:'变更',
//            type:2,
//            area:['800px','510px'],
//            content:'add.html',
//            maxmin:true,
//            success:function(){
//
//            },
//            error:function(){
//
//            }
//        })
//      }

		table.on('toolbar(expertList)', function(obj){
		    var checkStatus = table.checkStatus(obj.config.id);
		    if(obj.event==='isAll'){
		    	if(checkStatus.isAll){
		    		layer.open({
		    			title:'批量变更',
		    			type:2,
		    			area:['800px','500px'],
		    			content:
		    		})
		    	}
		    }
//		    switch(obj.event){
//		      case 'getCheckData':
//		        var data = checkStatus.data;
//		        layer.alert(JSON.stringify(data));
//		      break;
//		      case 'getCheckLength':
//		        var data = checkStatus.data;
//		        layer.msg('选中了：'+ data.length + ' 个');
//		      break;
//		      case 'isAll':
//		        layer.msg(checkStatus.isAll ? '全选': '未全选');
//		      break;
//		    };
		  });
        table.on("tool(expertList)",function(obj){
            var data = obj.data;
            if(obj.event==='edit'){
                layer.open({
                    type:2,
                    title:'编辑信息',
                    area:['800px','500px'],
                    fix:false,
                    content:'edit.html',
                    maxmin:true,
                    success:function(layero,index){
                        var iframe = window['layui-layer-iframe' + index];
                        iframe.child(data);
                    },
                    error:function(layero,index){

                    }
                })
            }
        })
</script>
</body>
</html>