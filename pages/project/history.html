<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="format-detection" content="telephone=no">
<title>南通科技局</title>
<!--<link rel="stylesheet" href="../../static/css/font.css" />-->
<link rel="stylesheet" href="../../lib/layui/css/layui.css" />
<link rel="stylesheet" href="../../css/style.css" />


</head>

<body>
    <div class="layui-tab-brief">
        <fieldset class="layui-elem-field">
            <div class="layui-field-box">
                <table class="style-table" id="demo" lay-filter="test">
                </table>
            </div>
        </fieldset>

    </div>
    <script type="text/html" id="barDemo">
        <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">查看</a>
        <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="files">附件</a>


    </script>
    <script type="text/javascript" src="../../js/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="../../js/main.js"></script>
    <script type="text/javascript" src="../../lib/layui/layui.js"></script>
    <script type="text/javascript">
        var table;

        function child(obj) {

            console.log(obj);
            layui.use(['table', 'layer'], function () {
                table = layui.table;
                var layer = layui.layer;
                table.render({
                    elem: '#demo',
                    url: baseUrl + '/project/getProjectApplyStatus',
                    where: { token: localStorage.getItem('token'), projectId: obj },
                    parseData: function (res) {

                        return {
                            "code": 0,
                            "msg": res.msg,
                            "data": res.data
                        }
                    },
                    page: false,//开启分页
                    cols: [
                        [
                            { field: 'name', title: '项目名称' },
                            { field: 'type', title: '申报类型' ,templet:function(e){
                                 if(e.type=='C100001'){
                                    return '新项目申报'
                                }else if(e.type=='C100002'){
                                    return '合同审核'
                                }else if(e.type=='C100003'){
                                    return "中期检查"
                                }else if(e.type=='C100004'){
                                    return "项目验收"
                                }else{
                                    return ""
                                }
                            }},
                            // { field: 'companyName', title: '申报单位' },
                            {field:'timeStr',title:'申请日期'},
                            {
                                field: 'status', templet: function (e) {
                                    if (e.status == 0) {
                                        return '<span style="color: red;">' + "待审核" + '</span>';
                                    } else if (e.status == 1) {
                                        return '<span style="color: red;">' + '审核中' + '</span>'
                                    } else if (e.status == 2) {
                                        return '<span style="color: red;">' + "通过" + '</span>';
                                    } else if (e.status == 3) {
                                        return '<span style="color: red;">' + "不通过" + '</span>'
                                    } else if (e.status == 4) {
                                        return '<span style="color: red;">' + "退回" + '</span>'
                                    }else{
                                        return "";
                                    }

                                }, title: '状态'
                            },
                            { fixed: 'right', width: 165, align: 'center', toolbar: '#barDemo', title: '操作' }
                        ]
                    ]


                });

                table.on('tool(test)', function (obj) {
                    var data = obj.data;//获得当前行数据
                    var layEvent = obj.event;//获得lay-event对应的值
                    if (layEvent == 'detail') {
                        layer.open({
                            type: 2,
                            area: ['900px', '300px'],
                            fix: false,//不固定
                            title: '详细信息',
                            content: 'history_detail.html',
                            success: function (layero, index) {
                                var iframe = window['layui-layer-iframe' + index];
                                iframe.child(data.id);

                            }

                        });
                    }else if(layEvent=='files'){
                        layer.open({
                            type: 2,
                            area: ['900px', '300px'],
                            fix: false,//不固定
                            title: '附件',
                            content: 'files.html',
                            success: function (layero, index) {
                                var iframe = window['layui-layer-iframe' + index];
                                iframe.child(data);

                            }

                        });
                    }
                })
            });

        }
    </script>

</body>

</html>